# üìù Task Examples - V√≠ D·ª• Th·ª±c T·∫ø

> **M·ª•c ƒë√≠ch:** H∆∞·ªõng d·∫´n t·ª´ng b∆∞·ªõc c√°ch fix bug v√† th√™m t√≠nh nƒÉng, v·ªõi code m·∫´u c·ª• th·ªÉ.

**Th·ªùi gian ƒë·ªçc:** ~20 ph√∫t | **C·∫•p ƒë·ªô:** Junior Developer

---

## üìö M·ª•c L·ª•c

1. [Task 1: Fix Bug - API Tr·∫£ V·ªÅ Data C≈©](#task-1-fix-bug---api-tr·∫£-v·ªÅ-data-c≈©)
2. [Task 2: Th√™m T√≠nh NƒÉng - Search/Filter](#task-2-th√™m-t√≠nh-nƒÉng---searchfilter)
3. [Task 3: Th√™m Ngu·ªìn Tin M·ªõi - Hacker News](#task-3-th√™m-ngu·ªìn-tin-m·ªõi---hacker-news)
4. [Task 4: Refactor - Implement Port](#task-4-refactor---implement-port)
5. [Task 5: Performance - Cache API Response](#task-5-performance---cache-api-response)

---

## Task 1: Fix Bug - API Tr·∫£ V·ªÅ Data C≈©

### üêõ M√¥ T·∫£ Bug

**User Report:**
> "T√¥i ƒë√£ ch·∫°y `python update_news.py` 10 ph√∫t tr∆∞·ªõc, nh∆∞ng website v·∫´n hi·ªÉn th·ªã tin c≈© t·ª´ s√°ng nay."

**Expected:** Data c·∫≠p nh·∫≠t sau khi ch·∫°y script  
**Actual:** Data v·∫´n c≈©

---

### üîç Debug Steps

#### B∆∞·ªõc 1: Ki·ªÉm tra file JSON

```bash
# Xem n·ªôi dung file summaries.json
cat data/outputs/summaries.json | head -20
```

**T√¨m field `last_updated`:**
```json
{
  "last_updated": "2025-10-29T08:00:00+07:00",
  ...
}
```

**Ki·ªÉm tra:**
- N·∫øu timestamp c≈© (8:00 s√°ng) ‚Üí Script kh√¥ng ch·∫°y th√†nh c√¥ng
- N·∫øu timestamp m·ªõi (10 ph√∫t tr∆∞·ªõc) ‚Üí Bug ·ªü API/Frontend

---

#### B∆∞·ªõc 2: Ki·ªÉm tra script c√≥ ch·∫°y th√†nh c√¥ng kh√¥ng

```bash
# Ch·∫°y l·∫°i script v·ªõi verbose output
python update_news.py --top 30
```

**K·∫øt qu·∫£ mong ƒë·ª£i:**
```
Fetching articles from Techmeme...
‚úì Found 15 articles
Summarizing with Gemini AI...
‚úì Summarized 15 articles
Saving to data/outputs/summaries.json...
‚úì Saved successfully
```

**N·∫øu l·ªói:**
- `ModuleNotFoundError` ‚Üí Thi·∫øu package (ch·∫°y `pip install -r requirements.txt`)
- `API Key error` ‚Üí Ki·ªÉm tra file `.env`
- `Network error` ‚Üí Ki·ªÉm tra internet

---

#### B∆∞·ªõc 3: Ki·ªÉm tra API response

**M·ªü browser Developer Tools:**
1. Press `F12`
2. Tab "Network"
3. Reload trang (Ctrl+R)
4. Click v√†o request `/api/summaries`
5. Xem Response:

```json
{
  "summaries": [...],
  "freshness": "8 hours ago",  // ‚Üê N·∫øu > 1 gi·ªù ‚Üí data c≈©
  "last_updated": "2025-10-29T08:00:00+07:00"
}
```

---

### üõ†Ô∏è Gi·∫£i Ph√°p

#### Gi·∫£i ph√°p 1: Server ƒëang cache

**Nguy√™n nh√¢n:** FastAPI cache response ho·∫∑c ƒë·ªçc file c≈©

**Fix:**
```bash
# Restart server
# Ctrl+C trong terminal ƒëang ch·∫°y uvicorn
# Sau ƒë√≥ ch·∫°y l·∫°i:
start_fastapi.bat
```

---

#### Gi·∫£i ph√°p 2: Browser cache

**Nguy√™n nh√¢n:** Browser cache file JavaScript c≈©

**Fix:**
- Hard refresh: `Ctrl + Shift + R` (Windows)
- Ho·∫∑c x√≥a cache: `Ctrl + Shift + Delete`

---

#### Gi·∫£i ph√°p 3: Script ch·∫°y sai file

**Nguy√™n nh√¢n:** C√≥ nhi·ªÅu file `summaries.json` (test, backup)

**Ki·ªÉm tra:**
```python
# File: src/services/storage_service.py
class StorageService:
    OUTPUT_FILE = "data/outputs/summaries.json"  # ‚Üê ƒê√∫ng path?
```

**Fix:** ƒê·∫£m b·∫£o path ƒë√∫ng, kh√¥ng c√≥ typo

---

#### Gi·∫£i ph√°p 4: File permissions

**Nguy√™n nh√¢n:** Script kh√¥ng c√≥ quy·ªÅn ghi file

**Ki·ªÉm tra (Windows):**
```powershell
# Ki·ªÉm tra quy·ªÅn
Get-Acl data\outputs\summaries.json
```

**Fix:**
- Right-click file ‚Üí Properties ‚Üí Security ‚Üí Edit permissions

---

### ‚úÖ Testing

**Sau khi fix, test l·∫°i:**

1. Ch·∫°y script:
   ```bash
   python update_news.py --top 5
   ```

2. Ki·ªÉm tra file:
   ```bash
   cat data/outputs/summaries.json | findstr "last_updated"
   ```
   ‚Üí Timestamp ph·∫£i l√† hi·ªán t·∫°i (v√†i gi√¢y tr∆∞·ªõc)

3. Reload browser (hard refresh)
4. Ki·ªÉm tra UI ‚Üí Data m·ªõi xu·∫•t hi·ªán ‚úÖ

---

### üìù Commit Message

```
fix: API returning stale data

- Issue: Server was caching old summaries.json
- Root cause: Forgot to restart server after running update_news.py
- Solution: Added note in README to restart server after updates
- Tested: Data now updates correctly after script run

Closes #42
```

---

## Task 2: Th√™m T√≠nh NƒÉng - Search/Filter

### üéØ Y√™u C·∫ßu

**User Story:**
> "L√† m·ªôt user, t√¥i mu·ªën search theo t·ª´ kh√≥a (v√≠ d·ª•: 'AI', 'blockchain') ƒë·ªÉ t√¨m c√°c b√†i vi·∫øt li√™n quan nhanh ch√≥ng."

**Acceptance Criteria:**
- [ ] C√≥ search box ph√≠a tr√™n danh s√°ch tin
- [ ] G√µ t·ª´ kh√≥a ‚Üí Filter real-time (kh√¥ng c·∫ßn reload page)
- [ ] Search trong c·∫£ title v√† summary
- [ ] Case-insensitive (kh√¥ng ph√¢n bi·ªát hoa/th∆∞·ªùng)
- [ ] Hi·ªÉn th·ªã s·ªë k·∫øt qu·∫£ t√¨m ƒë∆∞·ª£c

---

### üõ†Ô∏è Implementation

#### B∆∞·ªõc 1: Th√™m Search Box (HTML)

**File: `news.html` (ho·∫∑c `public/index.html`)**

T√¨m v·ªã tr√≠ th√≠ch h·ª£p (ph√≠a tr√™n news container), th√™m:

```html
<!-- Search Box -->
<div class="search-container">
    <input 
        type="text" 
        id="searchInput" 
        placeholder="Search articles (e.g., AI, blockchain)..."
        class="search-box"
    />
    <span id="searchResults" class="search-results-count"></span>
</div>

<!-- News Container (ƒë√£ c√≥) -->
<div id="news-container"></div>
```

---

#### B∆∞·ªõc 2: Styling (CSS)

**File: `styles/filters.css` (ho·∫∑c t·∫°o `styles/search.css` m·ªõi)**

```css
/* Search Container */
.search-container {
    display: flex;
    align-items: center;
    gap: 12px;
    margin-bottom: 20px;
    padding: 0 16px;
}

/* Search Box */
.search-box {
    flex: 1;
    padding: 12px 16px;
    font-size: 16px;
    border: 2px solid #e0e0e0;
    border-radius: 8px;
    transition: border-color 0.3s;
}

.search-box:focus {
    outline: none;
    border-color: #4285f4;
}

/* Results Count */
.search-results-count {
    color: #666;
    font-size: 14px;
    white-space: nowrap;
}
```

---

#### B∆∞·ªõc 3: Logic (JavaScript)

**File: `js/main.js`**

```javascript
// L∆∞u to√†n b·ªô summaries (kh√¥ng filter)
let allSummaries = [];

// H√†m kh·ªüi t·∫°o (ƒë√£ c√≥ - s·ª≠a l·∫°i)
document.addEventListener('DOMContentLoaded', async () => {
    showLoading();
    
    const data = await newsService.fetchSummaries();
    allSummaries = data.summaries;  // ‚Üê L∆∞u v√†o bi·∫øn global
    
    renderNews(allSummaries);
    hideLoading();
    
    // ‚≠ê Setup search
    setupSearch();
});

// ‚≠ê H√†m m·ªõi: Setup search functionality
function setupSearch() {
    const searchInput = document.getElementById('searchInput');
    const resultsCount = document.getElementById('searchResults');
    
    // Debounce: Ch·ªù 300ms sau khi user ng·ª´ng g√µ m·ªõi search
    let debounceTimer;
    
    searchInput.addEventListener('input', (e) => {
        clearTimeout(debounceTimer);
        
        debounceTimer = setTimeout(() => {
            const keyword = e.target.value.trim().toLowerCase();
            
            if (keyword === '') {
                // Kh√¥ng c√≥ keyword ‚Üí Hi·ªÉn th·ªã t·∫•t c·∫£
                renderNews(allSummaries);
                resultsCount.textContent = '';
            } else {
                // Filter theo keyword
                const filtered = filterByKeyword(keyword);
                renderNews(filtered);
                
                // Hi·ªÉn th·ªã s·ªë k·∫øt qu·∫£
                resultsCount.textContent = `${filtered.length} results`;
            }
        }, 300);
    });
}

// ‚≠ê H√†m filter
function filterByKeyword(keyword) {
    return allSummaries.filter(article => {
        const title = article.title.toLowerCase();
        const summary = article.summary.toLowerCase();
        
        // T√¨m trong c·∫£ title v√† summary
        return title.includes(keyword) || summary.includes(keyword);
    });
}
```

---

#### B∆∞·ªõc 4: Testing

**Manual Test Cases:**

| Test Case | Input | Expected |
|-----------|-------|----------|
| TC1 | G√µ "AI" | Hi·ªÉn th·ªã c√°c b√†i c√≥ "AI" trong title/summary |
| TC2 | G√µ "blockchain" | Filter ƒë√∫ng b√†i |
| TC3 | G√µ "xyz123" | Hi·ªÉn th·ªã "0 results" |
| TC4 | X√≥a h·∫øt text | Hi·ªÉn th·ªã l·∫°i t·∫•t c·∫£ b√†i |
| TC5 | G√µ "ai" (lowercase) | V·∫´n match "AI" (case-insensitive) ‚úÖ |

---

#### B∆∞·ªõc 5: Enhancement - Highlight Search Term

**Bonus feature:** L√†m n·ªïi b·∫≠t t·ª´ kh√≥a trong k·∫øt qu·∫£

```javascript
// File: js/ui/render.js

function createNewsCard(article, searchKeyword = '') {
    const card = document.createElement('div');
    card.className = 'news-card';
    
    // Highlight keyword n·∫øu c√≥
    let title = article.title;
    let summary = article.summary;
    
    if (searchKeyword) {
        const regex = new RegExp(`(${searchKeyword})`, 'gi');
        title = title.replace(regex, '<mark>$1</mark>');
        summary = summary.replace(regex, '<mark>$1</mark>');
    }
    
    card.innerHTML = `
        <h3><a href="${article.url}" target="_blank">${title}</a></h3>
        <p class="summary">${summary}</p>
        <div class="meta">
            <span class="source">${article.source}</span>
        </div>
    `;
    
    return card;
}
```

**CSS cho `<mark>`:**
```css
mark {
    background-color: #ffeb3b;
    padding: 2px 4px;
    border-radius: 2px;
}
```

---

### üìù Commit Message

```
feat: add search functionality for articles

- Added search box in UI with real-time filtering
- Search in both title and summary (case-insensitive)
- Display results count
- Debounce input (300ms) for performance
- Bonus: Highlight search terms in results

Closes #15
```

---

## Task 3: Th√™m Ngu·ªìn Tin M·ªõi - Hacker News

### üéØ Y√™u C·∫ßu

**User Story:**
> "L√† m·ªôt developer, t√¥i mu·ªën l·∫•y tin t·ª´ Hacker News ngo√†i Techmeme ƒë·ªÉ c√≥ nhi·ªÅu ngu·ªìn tin h∆°n."

**Acceptance Criteria:**
- [ ] Script h·ªó tr·ª£ argument `--source` (techmeme/hackernews/all)
- [ ] Hacker News API ho·∫°t ƒë·ªông t∆∞∆°ng t·ª± Techmeme
- [ ] Data c√≥ field `source` ƒë·ªÉ ph√¢n bi·ªát
- [ ] UI filter theo source

---

### üõ†Ô∏è Implementation

#### B∆∞·ªõc 1: T·∫°o Hacker News Client

**File: `src/feeds/hackernews/client.py` (t·∫°o m·ªõi)**

```python
"""
Hacker News Client - L·∫•y top stories t·ª´ HN API

API Documentation: https://github.com/HackerNews/API
"""

import requests
from typing import List, Dict
from datetime import datetime

class HackerNewsClient:
    BASE_URL = "https://hacker-news.firebaseio.com/v0"
    
    def fetch_feed(self, top_n: int = 30) -> List[Dict]:
        """
        L·∫•y top N stories t·ª´ Hacker News
        
        Returns:
            List[Dict]: Danh s√°ch articles
                {
                    "title": str,
                    "url": str,
                    "content": str (empty - HN kh√¥ng c√≥ full content),
                    "source": "Hacker News",
                    "published_date": str (ISO format)
                }
        """
        # B∆∞·ªõc 1: L·∫•y danh s√°ch top story IDs
        top_stories_url = f"{self.BASE_URL}/topstories.json"
        response = requests.get(top_stories_url, timeout=10)
        response.raise_for_status()
        
        story_ids = response.json()[:top_n]  # Ch·ªâ l·∫•y top N
        
        # B∆∞·ªõc 2: Fetch chi ti·∫øt t·ª´ng story
        articles = []
        for story_id in story_ids:
            story = self._fetch_story(story_id)
            if story:
                articles.append(story)
        
        return articles
    
    def _fetch_story(self, story_id: int) -> Dict:
        """L·∫•y chi ti·∫øt 1 story"""
        url = f"{self.BASE_URL}/item/{story_id}.json"
        
        try:
            response = requests.get(url, timeout=5)
            response.raise_for_status()
            data = response.json()
            
            # Convert sang format chu·∫©n
            return {
                "title": data.get("title", ""),
                "url": data.get("url", f"https://news.ycombinator.com/item?id={story_id}"),
                "content": "",  # HN kh√¥ng c√≥ full content
                "source": "Hacker News",
                "published_date": self._timestamp_to_iso(data.get("time"))
            }
        except Exception as e:
            print(f"Error fetching story {story_id}: {e}")
            return None
    
    def _timestamp_to_iso(self, timestamp: int) -> str:
        """Convert Unix timestamp sang ISO format"""
        if not timestamp:
            return datetime.now().isoformat()
        
        dt = datetime.fromtimestamp(timestamp)
        return dt.isoformat()
```

---

#### B∆∞·ªõc 2: S·ª≠a FeedService

**File: `src/services/feed_service.py`**

```python
from src.feeds.techmeme.client import TechmemeClient
from src.feeds.hackernews.client import HackerNewsClient  # ‚Üê Import m·ªõi

class FeedService:
    def fetch_latest_articles(self, source: str = "techmeme", top_n: int = 30):
        """
        L·∫•y articles t·ª´ ngu·ªìn ch·ªâ ƒë·ªãnh
        
        Args:
            source: "techmeme", "hackernews", ho·∫∑c "all"
            top_n: S·ªë l∆∞·ª£ng b√†i
        """
        articles = []
        
        if source in ["techmeme", "all"]:
            # L·∫•y t·ª´ Techmeme
            techmeme = TechmemeClient()
            techmeme_articles = techmeme.fetch_feed()[:top_n]
            articles.extend(techmeme_articles)
        
        if source in ["hackernews", "all"]:
            # L·∫•y t·ª´ Hacker News
            hn = HackerNewsClient()
            hn_articles = hn.fetch_feed(top_n)
            articles.extend(hn_articles)
        
        # N·∫øu "all" ‚Üí Gi·ªõi h·∫°n t·ªïng s·ªë
        if source == "all":
            articles = articles[:top_n]
        
        return articles
```

---

#### B∆∞·ªõc 3: S·ª≠a update_news.py

**File: `update_news.py`**

```python
import argparse

def main():
    parser = argparse.ArgumentParser(description='Update tech news')
    parser.add_argument('--top', type=int, default=30, help='Number of articles')
    parser.add_argument('--source', type=str, default='techmeme',
                        choices=['techmeme', 'hackernews', 'all'],
                        help='News source')  # ‚Üê Argument m·ªõi
    
    args = parser.parse_args()
    
    # Ch·∫°y pipeline v·ªõi source
    pipeline = NewsPipeline()
    summaries = pipeline.run(source=args.source, top_n=args.top)
    
    print(f"‚úì Saved {len(summaries)} summaries from {args.source}")

if __name__ == "__main__":
    main()
```

**S·ª≠a `NewsPipeline.run()`:**
```python
class NewsPipeline:
    def run(self, source: str = "techmeme", top_n: int = 30):
        # Fetch v·ªõi source parameter
        articles = self.feed_service.fetch_latest_articles(
            source=source,
            top_n=top_n
        )
        
        # ... rest of code
```

---

#### B∆∞·ªõc 4: Testing

**Test Commands:**

```bash
# Test Hacker News only
python update_news.py --source hackernews --top 10

# Test Techmeme only (default)
python update_news.py --source techmeme --top 10

# Test c·∫£ hai
python update_news.py --source all --top 20
```

**Ki·ªÉm tra output:**
```bash
cat data/outputs/summaries.json | findstr "source"
```

**Expected:**
```json
{
  "summaries": [
    {"title": "...", "source": "Hacker News"},
    {"title": "...", "source": "TechCrunch"},
    ...
  ]
}
```

---

### üìù Commit Message

```
feat: add Hacker News as news source

- Created HackerNewsClient to fetch from HN API
- Added --source argument to update_news.py
- Supports: techmeme, hackernews, or all
- Updated FeedService to handle multiple sources

Closes #23
```

---

## Task 4: Refactor - Implement Port

### üéØ M·ª•c ƒê√≠ch

Refactor `FeedService` theo **Hexagonal Architecture** (Port & Adapter pattern)

**Benefit:**
- ‚úÖ D·ªÖ test (mock port)
- ‚úÖ D·ªÖ m·ªü r·ªông (th√™m ngu·ªìn m·ªõi kh√¥ng s·ª≠a core logic)

---

### üõ†Ô∏è Implementation

#### B∆∞·ªõc 1: T·∫°o Port (Interface)

**File: `src/domain/ports.py` (t·∫°o m·ªõi)**

```python
"""
Domain Ports - Interfaces cho external dependencies
"""

from abc import ABC, abstractmethod
from typing import List
from src.domain.models import Article

class FeedPort(ABC):
    """
    Interface ƒë·ªÉ l·∫•y tin t·ª´ ngu·ªìn b√™n ngo√†i
    
    Implementers: TechmemeAdapter, HackerNewsAdapter
    """
    
    @abstractmethod
    def fetch_latest_articles(self, top_n: int) -> List[Article]:
        """
        L·∫•y top N b√†i vi·∫øt m·ªõi nh·∫•t
        
        Args:
            top_n: S·ªë l∆∞·ª£ng b√†i mu·ªën l·∫•y
            
        Returns:
            List[Article]: Danh s√°ch articles (domain model)
        """
        pass
```

---

#### B∆∞·ªõc 2: T·∫°o Domain Model

**File: `src/domain/models.py` (t·∫°o m·ªõi)**

```python
"""
Domain Models - Data classes thu·∫ßn t√∫y (kh√¥ng ph·ª• thu·ªôc framework)
"""

from dataclasses import dataclass
from datetime import datetime

@dataclass
class Article:
    """ƒê·∫°i di·ªán cho 1 b√†i vi·∫øt tin t·ª©c"""
    title: str
    url: str
    content: str
    source: str
    published_date: str
    
    def __post_init__(self):
        """Validation"""
        if not self.title:
            raise ValueError("Title cannot be empty")
        if not self.url:
            raise ValueError("URL cannot be empty")
```

---

#### B∆∞·ªõc 3: T·∫°o Adapter

**File: `src/infrastructure/feed_techmeme.py` (t·∫°o m·ªõi)**

```python
"""
Techmeme Adapter - Implement FeedPort
"""

from typing import List
from src.domain.ports import FeedPort
from src.domain.models import Article
from src.feeds.techmeme.client import TechmemeClient

class TechmemeAdapter(FeedPort):
    """Adapter cho Techmeme RSS feed"""
    
    def __init__(self):
        self.client = TechmemeClient()
    
    def fetch_latest_articles(self, top_n: int) -> List[Article]:
        # G·ªçi client c≈©
        raw_data = self.client.fetch_feed()
        
        # Convert sang Domain Model
        articles = []
        for item in raw_data[:top_n]:
            article = Article(
                title=item.get('title', ''),
                url=item.get('url', ''),
                content=item.get('content', ''),
                source='Techmeme',
                published_date=item.get('published', '')
            )
            articles.append(article)
        
        return articles
```

---

#### B∆∞·ªõc 4: S·ª≠ D·ª•ng Trong Use-Case

**File: `src/application/use_cases/summarize_uc.py` (t·∫°o m·ªõi)**

```python
"""
Summarize Use-Case - Orchestration logic
"""

from typing import List
from src.domain.ports import FeedPort, SummarizerPort, StoragePort
from src.domain.models import Summary

class SummarizeUC:
    """
    Use-case: L·∫•y tin ‚Üí T√≥m t·∫Øt ‚Üí L∆∞u
    
    Dependency Injection: Nh·∫≠n ports (interfaces), kh√¥ng ph·∫£i concrete classes
    """
    
    def __init__(
        self,
        feed_port: FeedPort,
        summarizer_port: SummarizerPort,
        storage_port: StoragePort
    ):
        self.feed_port = feed_port
        self.summarizer_port = summarizer_port
        self.storage_port = storage_port
    
    def execute(self, source: str, top_n: int) -> List[Summary]:
        """
        Ch·∫°y workflow
        
        Args:
            source: Ngu·ªìn tin (ƒë·ªÉ logging)
            top_n: S·ªë b√†i
            
        Returns:
            List[Summary]: K·∫øt qu·∫£ ƒë√£ t√≥m t·∫Øt
        """
        # B∆∞·ªõc 1: Fetch
        articles = self.feed_port.fetch_latest_articles(top_n)
        
        # B∆∞·ªõc 2: Summarize
        summaries = []
        for article in articles:
            summary_text = self.summarizer_port.summarize(article.content)
            
            summary = Summary(
                title=article.title,
                url=article.url,
                summary=summary_text,
                source=article.source,
                published_date=article.published_date
            )
            summaries.append(summary)
        
        # B∆∞·ªõc 3: Save
        self.storage_port.save_summaries(summaries)
        
        return summaries
```

---

#### B∆∞·ªõc 5: Wire Up (Dependency Injection)

**File: `update_news.py` (refactored)**

```python
from src.application.use_cases.summarize_uc import SummarizeUC
from src.infrastructure.feed_techmeme import TechmemeAdapter
from src.infrastructure.llm_gemini import GeminiAdapter
from src.infrastructure.storage_fs import FileSystemAdapter

def main():
    parser = argparse.ArgumentParser()
    parser.add_argument('--top', type=int, default=30)
    args = parser.parse_args()
    
    # Dependency Injection - t·∫°o adapters
    feed_adapter = TechmemeAdapter()
    summarizer_adapter = GeminiAdapter()
    storage_adapter = FileSystemAdapter()
    
    # T·∫°o use-case v·ªõi dependencies
    uc = SummarizeUC(
        feed_port=feed_adapter,
        summarizer_port=summarizer_adapter,
        storage_port=storage_adapter
    )
    
    # Ch·∫°y
    summaries = uc.execute(source="techmeme", top_n=args.top)
    print(f"‚úì Saved {len(summaries)} summaries")
```

---

#### B∆∞·ªõc 6: Unit Test

**File: `test/test_summarize_uc.py` (t·∫°o m·ªõi)**

```python
"""
Unit test cho SummarizeUC v·ªõi mocked ports
"""

import pytest
from unittest.mock import Mock
from src.application.use_cases.summarize_uc import SummarizeUC
from src.domain.models import Article

def test_summarize_uc_success():
    # Arrange: T·∫°o mock ports
    feed_port = Mock()
    summarizer_port = Mock()
    storage_port = Mock()
    
    # Mock data
    mock_articles = [
        Article(
            title="AI Breakthrough",
            url="https://example.com",
            content="Full article content...",
            source="Techmeme",
            published_date="2025-10-29T10:00:00Z"
        )
    ]
    feed_port.fetch_latest_articles.return_value = mock_articles
    summarizer_port.summarize.return_value = "AI has made significant progress."
    
    # Act: Ch·∫°y use-case
    uc = SummarizeUC(feed_port, summarizer_port, storage_port)
    summaries = uc.execute(source="techmeme", top_n=10)
    
    # Assert
    assert len(summaries) == 1
    assert summaries[0].title == "AI Breakthrough"
    assert summaries[0].summary == "AI has made significant progress."
    
    # Verify mocks ƒë∆∞·ª£c g·ªçi
    feed_port.fetch_latest_articles.assert_called_once_with(10)
    summarizer_port.summarize.assert_called_once()
    storage_port.save_summaries.assert_called_once()
```

**Ch·∫°y test:**
```bash
pytest test/test_summarize_uc.py -v
```

---

### üìù Commit Message

```
refactor: implement hexagonal architecture for feed service

- Created FeedPort interface in domain layer
- Implemented TechmemeAdapter in infrastructure
- Created SummarizeUC use-case with dependency injection
- Added unit tests with mocked ports
- Updated update_news.py to use new architecture

Breaking change: Old FeedService deprecated
Migration guide in docs/ARCHITECTURE_EXPLAINED.md

Closes #45
```

---

## Task 5: Performance - Cache API Response

### üéØ V·∫•n ƒê·ªÅ

**Observation:** M·ªói l·∫ßn user refresh page, server ƒë·ªçc l·∫°i file `summaries.json` (I/O operation).

**N·∫øu c√≥ 100 users c√πng l√∫c ‚Üí 100 l·∫ßn ƒë·ªçc file ‚Üí Ch·∫≠m!**

---

### üí° Gi·∫£i Ph√°p: In-Memory Cache

Cache data trong RAM (memory), ch·ªâ reload khi file thay ƒë·ªïi.

---

### üõ†Ô∏è Implementation

**File: `src/api/app.py`**

```python
from fastapi import FastAPI
from fastapi.responses import JSONResponse
import json
from datetime import datetime
from pathlib import Path

app = FastAPI()

# ‚≠ê Cache global
_cache = {
    "data": None,
    "last_modified": None
}

SUMMARIES_FILE = Path("data/outputs/summaries.json")

def get_summaries_cached():
    """
    ƒê·ªçc summaries v·ªõi caching
    
    Logic:
    - N·∫øu file kh√¥ng thay ƒë·ªïi ‚Üí Tr·∫£ cache
    - N·∫øu file m·ªõi ‚Üí ƒê·ªçc l·∫°i v√† update cache
    """
    global _cache
    
    # L·∫•y timestamp file
    file_mtime = SUMMARIES_FILE.stat().st_mtime
    
    # Ki·ªÉm tra cache
    if _cache["data"] and _cache["last_modified"] == file_mtime:
        # Cache hit!
        print("‚úì Cache hit")
        return _cache["data"]
    
    # Cache miss ‚Üí ƒê·ªçc file
    print("‚úó Cache miss - Reading file")
    with open(SUMMARIES_FILE, 'r', encoding='utf-8') as f:
        data = json.load(f)
    
    # Update cache
    _cache["data"] = data
    _cache["last_modified"] = file_mtime
    
    return data

@app.get("/api/summaries")
async def get_summaries():
    """API endpoint v·ªõi cache"""
    data = get_summaries_cached()  # ‚Üê D√πng cached version
    
    return JSONResponse({
        "summaries": data["summaries"],
        "freshness": calculate_age(data["last_updated"]),
        "total": len(data["summaries"]),
        "cached": _cache["last_modified"] is not None  # Debug info
    })
```

---

### üìä Performance Test

**Before (No Cache):**
```bash
# G·ªçi API 100 l·∫ßn
for i in {1..100}; do curl http://localhost:8000/api/summaries > /dev/null; done

# Th·ªùi gian: ~5 gi√¢y (50ms/request)
```

**After (With Cache):**
```bash
# G·ªçi API 100 l·∫ßn
for i in {1..100}; do curl http://localhost:8000/api/summaries > /dev/null; done

# Th·ªùi gian: ~0.5 gi√¢y (5ms/request)
# ‚Üí Nhanh h∆°n 10x! üöÄ
```

---

### üìù Commit Message

```
perf: add in-memory cache for summaries API

- Cache summaries.json in memory to avoid repeated file reads
- Invalidate cache when file modified (check mtime)
- Reduces response time from ~50ms to ~5ms (10x faster)
- Added cache hit/miss logging for debugging

Closes #67
```

---

## üéì T·ªïng K·∫øt

Sau khi l√†m 5 tasks n√†y, b·∫°n ƒë√£ h·ªçc ƒë∆∞·ª£c:

‚úÖ **Debug skills:** T√¨m root cause c·ªßa bug  
‚úÖ **Feature development:** Th√™m search/filter  
‚úÖ **Integration:** Th√™m ngu·ªìn data m·ªõi (Hacker News)  
‚úÖ **Refactoring:** Implement design pattern (Hexagonal)  
‚úÖ **Performance:** Optimize v·ªõi caching  

---

## üìñ ƒê·ªçc Ti·∫øp

- **[ONBOARDING_GUIDE.md](ONBOARDING_GUIDE.md)** ‚Üí Hi·ªÉu d·ª± √°n t·ªïng quan
- **[COMMON_PITFALLS.md](COMMON_PITFALLS.md)** ‚Üí L·ªói th∆∞·ªùng g·∫∑p
- **[CONTRIBUTION_GUIDE.md](CONTRIBUTION_GUIDE.md)** ‚Üí Quy tr√¨nh coding

---

**Ch√∫c b·∫°n coding vui v·∫ª! üöÄ**
